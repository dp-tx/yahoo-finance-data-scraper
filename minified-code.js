function W(){for(a=document.getElementsByTagName("a"),b=null,i=0;i<a.length;i++)if("Download"==a[i].innerText){b=a[i];break}if(null==b)throw alert("The script was not able to locate the HTML link element for the download button."),new Error;return b}function X(){c=null,f=document.querySelectorAll("table");for(let t=0;t<f.length;t++)if(e=f[t],d=e.querySelectorAll("thead tr th"),"Date"==d[0].innerText&&"Open"==d[1].innerText&&"High"==d[2].innerText){c=e;break}if(null==c)throw alert("The script was not able to locate the HTML table element that contains the financial data."),new Error;return c}function Z(){g=null,h=null,l=document.getElementsByClassName("tertiary-btn fin-size-small");for(let e=0;e<l.length;e++)k=l[e],k.innerText.includes("-")&&["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].includes(k.innerText.substr(0,3))&&(g=k),["Daily","Weekly","Monthly"].includes(k.innerText)&&(h=k);if(null==g||null==h)throw alert("The script was not able to locate the HTML button elements that contain the dates and frequency."),new Error;return[g,h]}function Y(){m=null,o=document.getElementsByTagName("h1");for(let e=0;e<o.length;e++)if(n=o[e],"section"==n.parentElement.tagName.toLowerCase()){m=n;break}if(null==m)throw alert("The script was not able to locate the HTML label with the name and ticker symbol"),new Error;return m}function R(){let e=Z();q=e[0],r=e[1],s=X(),v=Y(),u="",s.querySelectorAll("thead tr th").forEach((e=>{u+=e.innerText.trim()+","})),u=u.substr(0,u.length-1)+"\n",y=s.querySelectorAll("tbody tr");for(let e=0;e<y.length;e++)a="",y[e].querySelectorAll("td").forEach((e=>{a+=e.innerText.trim().replaceAll(",","")+","})),z=a.split(" "),a=z[1]+"-"+z[0]+"-"+z.slice(2,z.length).join(""),a=a.substr(0,a.length-1)+"\n",u+=a;return w=v.innerText.trim(),x=w+" "+r.innerText+" "+q.innerText+".csv",[x,u]}Q=W(),Q.children.length>=1&&Q.children[0].remove(),Q.href="#",Q.addEventListener("click",(function(){T=R();const e=T[1],t=new Blob([e],{type:"text/plain"}),n=document.createElement("a"),l=URL.createObjectURL(t);n.href=l,n.download=T[0],n.click(),n.remove()}));
